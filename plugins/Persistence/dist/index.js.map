{"version":3,"file":"index.js","sources":["../src/Persistence.ts"],"sourcesContent":["\nimport { Plugin, StateValueAtRoot } from '@hookstate/core';\n\nconst PluginID = Symbol('LocalPersistence');\n\n// tslint:disable-next-line: function-name\nexport function Persistence(localStorageKey: string): (() => Plugin) {\n    return () => ({\n        id: PluginID,\n        instanceFactory: (initial: StateValueAtRoot) => {\n            return {\n                onInit: () => {\n                    const persisted = localStorage.getItem(localStorageKey);\n                    if (persisted !== null) {\n                        const result = JSON.parse(persisted);\n                        return result;\n                    }\n                    localStorage.setItem(localStorageKey, JSON.stringify(initial))\n                    return initial;\n                },\n                onSet: (p, v) => {\n                    localStorage.setItem(localStorageKey, JSON.stringify(v));\n                }\n            }\n        }\n    })\n}\n"],"names":[],"mappings":";;;;AAGA,IAAM,QAAQ,GAAG,MAAM,CAAC,kBAAkB,CAAC,CAAC;;AAG5C,SAAgB,WAAW,CAAC,eAAuB;IAC/C,OAAO,cAAM,QAAC;QACV,EAAE,EAAE,QAAQ;QACZ,eAAe,EAAE,UAAC,OAAyB;YACvC,OAAO;gBACH,MAAM,EAAE;oBACJ,IAAM,SAAS,GAAG,YAAY,CAAC,OAAO,CAAC,eAAe,CAAC,CAAC;oBACxD,IAAI,SAAS,KAAK,IAAI,EAAE;wBACpB,IAAM,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;wBACrC,OAAO,MAAM,CAAC;qBACjB;oBACD,YAAY,CAAC,OAAO,CAAC,eAAe,EAAE,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,CAAA;oBAC9D,OAAO,OAAO,CAAC;iBAClB;gBACD,KAAK,EAAE,UAAC,CAAC,EAAE,CAAC;oBACR,YAAY,CAAC,OAAO,CAAC,eAAe,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;iBAC5D;aACJ,CAAA;SACJ;KACJ,IAAC,CAAA;CACL;;;;"}