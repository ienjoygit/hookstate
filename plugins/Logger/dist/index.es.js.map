{"version":3,"file":"index.es.js","sources":["../src/Logger.ts"],"sourcesContent":["\nimport {\n    Plugin,\n    Path,\n    StateValueAtRoot,\n    StateValueAtPath,\n    PluginCallbacks,\n    StateLink,\n    StateLinkPlugable,\n    PluginCallbacksOnSetArgument\n} from '@hookstate/core';\n\nexport interface LoggerExtensions {\n    log(): void;\n}\n\nclass LoggerPluginInstance implements PluginCallbacks {\n    toJsonTrimmed(s: StateValueAtPath) {\n        const limit = 100;\n        const r = JSON.stringify(s);\n        if (r && r.length > 100) {\n            return `${r.slice(0, limit)}... (${r.length - limit} characters trunkated)`\n        }\n        return r;\n    }\n\n    onSet(p: PluginCallbacksOnSetArgument) {\n        // tslint:disable-next-line: no-console\n        console.log(\n            `[hookstate]: new value set at path '/${p.path.join('/')}': ` +\n            `${this.toJsonTrimmed(p.value)}`,\n            p);\n    }\n\n    log(l: StateLink<StateValueAtPath> & StateLinkPlugable<StateValueAtPath>) {\n        // tslint:disable-next-line: no-console\n        return console.log(\n            `[hookstate]: current value at path '/${l.path.join('/')}: ` +\n            `${this.toJsonTrimmed(l.getUntracked())}'`,\n            {\n                path: l.path,\n                value: l.getUntracked()\n            });\n    }\n}\n\nconst PluginID = Symbol('Logger');\n\n// tslint:disable-next-line: function-name\nexport function Logger(): Plugin;\nexport function Logger<S>(self: StateLink<S>): LoggerExtensions;\nexport function Logger<S>(self?: StateLink<S>): Plugin | LoggerExtensions {\n    if (self) {\n        const [link, instance] = self.with(PluginID);\n        const inst = instance as LoggerPluginInstance;\n        return {\n            log: () => inst.log(link)\n        }\n    }\n    return {\n        id: PluginID,\n        create: () => {\n            // tslint:disable-next-line: no-console\n            console.log(`[hookstate]: logger attached`);\n            return new LoggerPluginInstance();\n        }\n    }\n}\n"],"names":[],"mappings":"AAgBA;IAAA;KA4BC;IA3BG,4CAAa,GAAb,UAAc,CAAmB;QAC7B,IAAM,KAAK,GAAG,GAAG,CAAC;QAClB,IAAM,CAAC,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;QAC5B,IAAI,CAAC,IAAI,CAAC,CAAC,MAAM,GAAG,GAAG,EAAE;YACrB,OAAU,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,KAAK,CAAC,cAAQ,CAAC,CAAC,MAAM,GAAG,KAAK,4BAAwB,CAAA;SAC9E;QACD,OAAO,CAAC,CAAC;KACZ;IAED,oCAAK,GAAL,UAAM,CAA+B;;QAEjC,OAAO,CAAC,GAAG,CACP,0CAAwC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,QAAK;aAC7D,KAAG,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,KAAK,CAAG,CAAA,EAChC,CAAC,CAAC,CAAC;KACV;IAED,kCAAG,GAAH,UAAI,CAAoE;;QAEpE,OAAO,OAAO,CAAC,GAAG,CACd,0CAAwC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,OAAI;aACzD,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,YAAY,EAAE,CAAC,MAAG,CAAA,EAC1C;YACI,IAAI,EAAE,CAAC,CAAC,IAAI;YACZ,KAAK,EAAE,CAAC,CAAC,YAAY,EAAE;SAC1B,CAAC,CAAC;KACV;IACL,2BAAC;AAAD,CAAC,IAAA;AAED,IAAM,QAAQ,GAAG,MAAM,CAAC,QAAQ,CAAC,CAAC;SAKlB,MAAM,CAAI,IAAmB;IACzC,IAAI,IAAI,EAAE;QACA,IAAA,wBAAsC,EAArC,cAAI,EAAE,gBAA+B,CAAC;QAC7C,IAAM,MAAI,GAAG,QAAgC,CAAC;QAC9C,OAAO;YACH,GAAG,EAAE,cAAM,OAAA,MAAI,CAAC,GAAG,CAAC,MAAI,CAAC,GAAA;SAC5B,CAAA;KACJ;IACD,OAAO;QACH,EAAE,EAAE,QAAQ;QACZ,MAAM,EAAE;;YAEJ,OAAO,CAAC,GAAG,CAAC,8BAA8B,CAAC,CAAC;YAC5C,OAAO,IAAI,oBAAoB,EAAE,CAAC;SACrC;KACJ,CAAA;AACL;;;;"}